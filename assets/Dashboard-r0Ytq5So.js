import{a as D,u as F,b as L,j as e,A as M,B as o,d as c,F as u,h as V,i as P,M as S,m as g,k as U}from"./index-CKtLAY6U.js";import{u as j}from"./useQuery-B2Asmr9A.js";import{S as a}from"./skeleton-ByPZWHvL.js";import{S as d}from"./StatsCard-VtrwtCjV.js";import{A as E}from"./AppointmentCard-BD2pdTB0.js";import{M as q}from"./MedicalRecordCard-DsTID6DH.js";import{E as v}from"./EmptyState-CQHcWt1d.js";import{P as Y}from"./plus-w_6fjgXs.js";import"./format-BLBLR528.js";import"./video-BMusQ2iJ.js";import"./map-pin-1gWrfaD2.js";import"./download-upueqEdR.js";function X(){const t=D(),{user:w}=F(),{toast:r}=L(),{data:N,isLoading:p,error:b}=j({queryKey:["appointments","upcoming"],queryFn:async()=>await U.getAll({status:"scheduled"})}),{data:y,isLoading:f,error:k}=j({queryKey:["medical-records","recent"],queryFn:async()=>await g.getAll({})}),i=N?.slice(0,3)||[],l=y?.slice(0,5)||[],m=l.filter(s=>s.isNew).length,A=s=>{t(`/patient/appointments/${s}`)},C=s=>{window.open(s,"_blank","noopener,noreferrer"),r({title:"Opening video call",description:"Your virtual appointment is opening in a new window.",variant:"success"})},R=s=>{r({title:"Medical Records",description:"Medical records viewer coming soon!",variant:"info"})},B=async s=>{try{const x=await g.download(s),h=window.URL.createObjectURL(x),n=document.createElement("a");n.href=h,n.download=`medical-record-${s}.pdf`,document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(h),r({title:"Download started",description:"Your medical record is being downloaded.",variant:"success"})}catch{r({title:"Download failed",description:"Failed to download medical record. Please try again.",variant:"destructive"})}};return e.jsxs("div",{className:"h-screen flex flex-col bg-neutral-light",children:[e.jsx(M,{title:"Patient Dashboard"}),e.jsxs("div",{className:"flex-1 overflow-auto",children:[e.jsx("div",{className:"bg-white border-b border-neutral-blue-gray/10",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-h1 text-neutral-blue-gray",children:["Welcome back, ",w?.firstName,"!"]}),e.jsx("p",{className:"text-body text-neutral-blue-gray/70 mt-1",children:"Here's your health overview"})]}),e.jsxs(o,{onClick:()=>t("/patient/appointments/book"),children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),"Book Appointment"]})]})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:p?e.jsxs(e.Fragment,{children:[e.jsx(a,{className:"h-32"}),e.jsx(a,{className:"h-32"}),e.jsx(a,{className:"h-32"})]}):e.jsxs(e.Fragment,{children:[e.jsx(d,{title:"Upcoming Appointments",value:i.length,icon:c,description:i.length>0?`Next: ${i[0]?.date}`:"No upcoming appointments",iconColor:"text-primary",iconBgColor:"bg-primary/10"}),e.jsx(d,{title:"New Medical Records",value:m,icon:u,description:m>0?"Unread records available":"All caught up!",iconColor:"text-info",iconBgColor:"bg-info/10"}),e.jsx(d,{title:"Health Status",value:"Good",icon:V,description:"Based on recent checkups",iconColor:"text-wellness",iconBgColor:"bg-wellness/10"})]})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 mb-8",children:[e.jsxs(o,{variant:"outline",className:"h-auto py-4 flex-col gap-2",onClick:()=>t("/patient/appointments/book"),children:[e.jsx(c,{className:"h-6 w-6"}),e.jsx("span",{children:"Book Appointment"})]}),e.jsxs(o,{variant:"outline",className:"h-auto py-4 flex-col gap-2",onClick:()=>t("/patient/appointments"),children:[e.jsx(P,{className:"h-6 w-6"}),e.jsx("span",{children:"View All Appointments"})]}),e.jsxs(o,{variant:"outline",className:"h-auto py-4 flex-col gap-2",onClick:()=>t("/patient/messages"),children:[e.jsx(S,{className:"h-6 w-6"}),e.jsx("span",{children:"Message Provider"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-h2 text-neutral-blue-gray",children:"Upcoming Appointments"}),i.length>0&&e.jsx(o,{variant:"link",onClick:()=>t("/patient/appointments"),children:"View all"})]}),p?e.jsxs("div",{className:"space-y-4",children:[e.jsx(a,{className:"h-48"}),e.jsx(a,{className:"h-48"})]}):b?e.jsx("div",{className:"bg-white rounded-lg p-6 border border-error/20",children:e.jsx("p",{className:"text-error",children:"Failed to load appointments. Please try again."})}):i.length===0?e.jsx(v,{icon:c,title:"No upcoming appointments",description:"You don't have any scheduled appointments. Book one to see your healthcare provider.",actionLabel:"Book Appointment",onAction:()=>t("/patient/appointments/book")}):e.jsx("div",{className:"space-y-4",children:i.map(s=>e.jsx(E,{appointment:s,onViewDetails:A,onJoinVideo:C,compact:!0},s.id))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-h2 text-neutral-blue-gray",children:"Recent Medical Records"}),l.length>0&&e.jsx(o,{variant:"link",children:"View all"})]}),f?e.jsxs("div",{className:"space-y-4",children:[e.jsx(a,{className:"h-32"}),e.jsx(a,{className:"h-32"}),e.jsx(a,{className:"h-32"})]}):k?e.jsx("div",{className:"bg-white rounded-lg p-6 border border-error/20",children:e.jsx("p",{className:"text-error",children:"Failed to load medical records. Please try again."})}):l.length===0?e.jsx(v,{icon:u,title:"No medical records",description:"Your medical records will appear here once they are available."}):e.jsx("div",{className:"space-y-4",children:l.map(s=>e.jsx(q,{record:s,onView:R,onDownload:B,compact:!0},s.id))})]})]})]})]})]})}export{X as default};
