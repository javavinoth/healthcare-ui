import{j as e,C as y,g as b,s as w,a0 as C,d as A,r as h,I as M,B as f,X as S,a1 as E,a as P,A as N,W as R,$ as T}from"./index-BCzS7ZUT.js";import{u as k}from"./useQuery-BEZ1twdU.js";import{A as L,b as z}from"./avatar-tXxi9PAK.js";import{f as D}from"./format-BLBLR528.js";import{S as F}from"./search-C7g3db3w.js";import{C as I}from"./chevron-right-CUMWbcnm.js";import{S as g}from"./skeleton-D_UUF4rd.js";function $({patient:s,onClick:r}){const i=(a,n)=>`${a.charAt(0)}${n.charAt(0)}`.toUpperCase(),t=a=>{if(!a)return"N/A";try{return D(new Date(a),"MMM d, yyyy")}catch{return"N/A"}},d=a=>a&&{MALE:"M",FEMALE:"F",OTHER:"Other",PREFER_NOT_TO_SAY:""}[a]||"";return e.jsx(y,{className:"cursor-pointer hover:shadow-lg transition-shadow duration-200 border-l-4 border-l-primary",onClick:()=>r(s.id),children:e.jsx(b,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx(L,{className:"h-12 w-12 bg-primary/10",children:e.jsx(z,{className:"bg-primary text-white font-semibold",children:i(s.firstName,s.lastName)})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("h3",{className:"font-semibold text-lg truncate",children:[s.firstName," ",s.lastName,s.age&&e.jsxs("span",{className:"text-muted-foreground text-sm font-normal ml-2",children:[s.age,"y ",d(s.gender)]})]}),s.medicalRecordNumber&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:["MRN: ",s.medicalRecordNumber]})]}),s.hasUnreadRecords&&e.jsx(w,{variant:"destructive",className:"shrink-0",children:"New Records"})]}),e.jsx("div",{className:"mt-2 space-y-1",children:s.email&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(C,{className:"h-3.5 w-3.5"}),e.jsx("span",{className:"truncate",children:s.email})]})}),e.jsxs("div",{className:"mt-3 pt-3 border-t flex items-center gap-4 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(A,{className:"h-3.5 w-3.5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Last visit: "}),e.jsx("span",{className:"font-medium",children:t(s.lastAppointmentDate)})]})]}),s.upcomingAppointmentDate&&e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:"text-muted-foreground",children:"Next: "}),e.jsx("span",{className:"font-medium text-primary",children:t(s.upcomingAppointmentDate)})]})]})]})]})})})}function B({onSearch:s,placeholder:r="Search by name, phone, or MRN",debounceMs:i=300}){const[t,d]=h.useState(""),a=h.useRef(void 0);h.useEffect(()=>(a.current&&clearTimeout(a.current),a.current=setTimeout(()=>{s(t)},i),()=>{a.current&&clearTimeout(a.current)}),[t,i,s]);const n=()=>{d(""),s("")};return e.jsxs("div",{className:"relative w-full",children:[e.jsx(F,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(M,{type:"text",placeholder:r,value:t,onChange:o=>d(o.target.value),className:"pl-10 pr-10"}),t&&e.jsxs(f,{type:"button",variant:"ghost",size:"sm",onClick:n,className:"absolute right-1 top-1/2 -translate-y-1/2 h-7 w-7 p-0",children:[e.jsx(S,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Clear search"})]})]})}function O({currentPage:s,totalPages:r,totalElements:i,pageSize:t,hasNext:d,hasPrevious:a,onPageChange:n}){const o=()=>{const c=[];if(r<=5)for(let m=0;m<r;m++)c.push(m);else{let m=Math.max(0,s-2),x=Math.min(r-1,s+2);s<2?x=Math.min(r-1,4):s>r-3&&(m=Math.max(0,r-5));for(let l=m;l<=x;l++)c.push(l)}return c},u=s*t+1,p=Math.min((s+1)*t,i);return r===0?null:e.jsxs("div",{className:"flex items-center justify-between gap-4 py-4",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",e.jsx("span",{className:"font-medium",children:u})," to"," ",e.jsx("span",{className:"font-medium",children:p})," of"," ",e.jsx("span",{className:"font-medium",children:i})," patients"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(f,{variant:"outline",size:"sm",onClick:()=>n(s-1),disabled:!a,children:[e.jsx(E,{className:"h-4 w-4 mr-1"}),"Previous"]}),e.jsx("div",{className:"hidden sm:flex items-center gap-1",children:o().map(c=>e.jsx(f,{variant:c===s?"default":"outline",size:"sm",onClick:()=>n(c),className:"min-w-[2.5rem]",children:c+1},c))}),e.jsxs(f,{variant:"outline",size:"sm",onClick:()=>n(s+1),disabled:!d,children:["Next",e.jsx(I,{className:"h-4 w-4 ml-1"})]})]})]})}function K(){const s=P(),[r,i]=h.useState(0),[t,d]=h.useState(""),{data:a,isLoading:n,isError:o,error:u}=k({queryKey:["provider-patients",r,t],queryFn:()=>T.getPatients({page:r,size:20,search:t||void 0}),staleTime:120*1e3}),p=l=>{d(l),i(0)},c=l=>{i(l),window.scrollTo({top:0,behavior:"smooth"})},j=l=>{s(`/provider/patients/${l}`)};if(n)return e.jsxs("div",{className:"h-screen flex flex-col bg-gray-50",children:[e.jsx(N,{title:"My Patients"}),e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[e.jsx("div",{className:"mb-6",children:e.jsx(g,{className:"h-10 w-full max-w-md"})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[...Array(6)].map((l,v)=>e.jsx(g,{className:"h-40"},v))})]})})]});if(o)return e.jsxs("div",{className:"h-screen flex flex-col bg-gray-50",children:[e.jsx(N,{title:"My Patients"}),e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"bg-destructive/10 border border-destructive/20 rounded-lg p-6 text-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-destructive mb-2",children:"Error Loading Patients"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:u instanceof Error?u.message:"An error occurred"})]})})})]});const m=a?.data||[],x=m.length===0;return e.jsxs("div",{className:"h-screen flex flex-col bg-gray-50",children:[e.jsx(N,{title:"My Patients"}),e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"My Patients"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"View and manage your patients"})]}),e.jsx("div",{className:"mb-6 max-w-md",children:e.jsx(B,{onSearch:p})}),x&&e.jsxs("div",{className:"bg-white border-2 border-dashed rounded-lg p-12 text-center",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"h-16 w-16 bg-primary/10 rounded-full flex items-center justify-center",children:e.jsx(R,{className:"h-8 w-8 text-primary"})})}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:t?"No patients found":"No patients yet"}),e.jsx("p",{className:"text-sm text-muted-foreground max-w-sm mx-auto",children:t?`No patients match "${t}". Try a different search term.`:"Patients you have appointments with will appear here."})]}),!x&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6",children:m.map(l=>e.jsx($,{patient:l,onClick:j},l.id))}),a&&a.totalPages>1&&e.jsx(O,{currentPage:a.page,totalPages:a.totalPages,totalElements:a.total,pageSize:a.pageSize,hasNext:a.page<a.totalPages-1,hasPrevious:a.page>0,onPageChange:c})]})]})})]})}export{K as default};
