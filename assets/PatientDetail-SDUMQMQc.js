import{t as ee,j as e,C as E,c as k,e as R,U as Y,g as S,a0 as Oe,S as Ie,a8 as W,s as U,d as G,F as B,b as se,E as te,r as w,y as ae,z as re,G as ie,N as ne,O as le,P as ce,Q as de,R as oe,a9 as ye,aa as be,ab as F,ac as O,L as o,I as h,l as me,n as xe,o as ue,p as he,q,B as v,X as pe,ad as Me,v as je,$ as M,w as x,ae as ke,af as Ce,u as we,ag as Ne,K as Re,a as qe,A as J}from"./index-DQCym86-.js";import{u as Q}from"./useQuery-DL9xNQeA.js";import{M as Ve}from"./map-pin-Bvq5cZ61.js";import{n as Ue,s as ge,c as Pe,t as fe,m as Ae,a as De,f as I}from"./format-BLBLR528.js";import{c as Be,i as ze,a as _e,S as Le}from"./scroll-area-C04ESy9v.js";import{T as V}from"./textarea-DGXRkvEY.js";import{P as Te}from"./plus-CNWlo1Xq.js";import{L as Ee}from"./loader-circle-DotnWznS.js";import{S as C}from"./separator-M9_e-Kfi.js";import{S as b}from"./skeleton-DukrQFjR.js";import{S as $e}from"./square-pen-CFuqrWD5.js";import"./subDays-MrZTzTeD.js";/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=[["path",{d:"M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2",key:"18mbvz"}],["path",{d:"M6.453 15h11.094",key:"3shlmq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}]],Ge=ee("flask-conical",He);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],Ke=ee("phone",Ye);/**
 * @license lucide-react v0.546.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=[["path",{d:"m10.5 20.5 10-10a4.95 4.95 0 1 0-7-7l-10 10a4.95 4.95 0 1 0 7 7Z",key:"wa1lgi"}],["path",{d:"m8.5 8.5 7 7",key:"rvfmvr"}]],z=ee("pill",Qe);function We(s,t,a){const[n,r]=Ue(a?.in,s,t);return+ge(n,a)==+ge(r,a)}function Ze(s,t){return We(Pe(s,s),Be(s),t)}function ve(s,t){const a=()=>Pe(t?.in,NaN),r=ss(s);let i;if(r.date){const l=ts(r.date,2);i=as(l.restDateString,l.year)}if(!i||isNaN(+i))return a();const j=+i;let m=0,c;if(r.time&&(m=rs(r.time),isNaN(m)))return a();if(r.timezone){if(c=is(r.timezone),isNaN(c))return a()}else{const l=new Date(j+m),d=fe(0,t?.in);return d.setFullYear(l.getUTCFullYear(),l.getUTCMonth(),l.getUTCDate()),d.setHours(l.getUTCHours(),l.getUTCMinutes(),l.getUTCSeconds(),l.getUTCMilliseconds()),d}return fe(j+m+c,t?.in)}const K={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},Je=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,Xe=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,es=/^([+-])(\d{2})(?::?(\d{2}))?$/;function ss(s){const t={},a=s.split(K.dateTimeDelimiter);let n;if(a.length>2)return t;if(/:/.test(a[0])?n=a[0]:(t.date=a[0],n=a[1],K.timeZoneDelimiter.test(t.date)&&(t.date=s.split(K.timeZoneDelimiter)[0],n=s.substr(t.date.length,s.length))),n){const r=K.timezone.exec(n);r?(t.time=n.replace(r[1],""),t.timezone=r[1]):t.time=n}return t}function ts(s,t){const a=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),n=s.match(a);if(!n)return{year:NaN,restDateString:""};const r=n[1]?parseInt(n[1]):null,i=n[2]?parseInt(n[2]):null;return{year:i===null?r:i*100,restDateString:s.slice((n[1]||n[2]).length)}}function as(s,t){if(t===null)return new Date(NaN);const a=s.match(Je);if(!a)return new Date(NaN);const n=!!a[4],r=H(a[1]),i=H(a[2])-1,j=H(a[3]),m=H(a[4]),c=H(a[5])-1;if(n)return os(t,m,c)?ns(t,m,c):new Date(NaN);{const l=new Date(0);return!cs(t,i,j)||!ds(t,r)?new Date(NaN):(l.setUTCFullYear(t,i,Math.max(r,j)),l)}}function H(s){return s?parseInt(s):1}function rs(s){const t=s.match(Xe);if(!t)return NaN;const a=X(t[1]),n=X(t[2]),r=X(t[3]);return ms(a,n,r)?a*Ae+n*De+r*1e3:NaN}function X(s){return s&&parseFloat(s.replace(",","."))||0}function is(s){if(s==="Z")return 0;const t=s.match(es);if(!t)return 0;const a=t[1]==="+"?-1:1,n=parseInt(t[2]),r=t[3]&&parseInt(t[3])||0;return xs(n,r)?a*(n*Ae+r*De):NaN}function ns(s,t,a){const n=new Date(0);n.setUTCFullYear(s,0,4);const r=n.getUTCDay()||7,i=(t-1)*7+a+1-r;return n.setUTCDate(n.getUTCDate()+i),n}const ls=[31,null,31,30,31,30,31,31,30,31,30,31];function Se(s){return s%400===0||s%4===0&&s%100!==0}function cs(s,t,a){return t>=0&&t<=11&&a>=1&&a<=(ls[t]||(Se(s)?29:28))}function ds(s,t){return t>=1&&t<=(Se(s)?366:365)}function os(s,t,a){return t>=1&&t<=53&&a>=0&&a<=6}function ms(s,t,a){return s===24?t===0&&a===0:a>=0&&a<60&&t>=0&&t<60&&s>=0&&s<25}function xs(s,t){return t>=0&&t<=59}function us({patient:s}){const t=r=>{if(!r)return"Not provided";try{return I(new Date(r),"MMMM d, yyyy")}catch{return"Invalid date"}},a=r=>r?{MALE:"Male",FEMALE:"Female",OTHER:"Other",PREFER_NOT_TO_SAY:"Prefer not to say"}[r]||r:"Not specified",n=()=>{const{address:r}=s;return r?.line1?[r.line1,r.line2,r.city&&r.state?`${r.city}, ${r.state} ${r.zipCode||""}`.trim():r.city||r.state].filter(Boolean).join(", "):"Not provided"};return e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(E,{children:[e.jsx(k,{children:e.jsxs(R,{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"h-5 w-5"}),"Demographics & Contact"]})}),e.jsxs(S,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Full Name"}),e.jsxs("p",{className:"mt-1",children:[s.firstName," ",s.lastName]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Medical Record Number"}),e.jsx("p",{className:"mt-1 font-mono",children:s.medicalRecordNumber||"Not assigned"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Date of Birth"}),e.jsx("p",{className:"mt-1",children:t(s.dateOfBirth)}),s.age&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:[s.age," years old"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Gender"}),e.jsx("p",{className:"mt-1",children:a(s.gender)})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(Oe,{className:"h-4 w-4"}),"Email"]}),e.jsx("p",{className:"mt-1",children:s.email||"Not provided"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(Ke,{className:"h-4 w-4"}),"Phone"]}),e.jsx("p",{className:"mt-1",children:s.phoneNumber||"Not provided"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(Ve,{className:"h-4 w-4"}),"Address"]}),e.jsx("p",{className:"mt-1 text-sm",children:n()})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(E,{children:[e.jsx(k,{children:e.jsxs(R,{className:"flex items-center gap-2",children:[e.jsx(Ie,{className:"h-5 w-5"}),"Insurance Information"]})}),e.jsxs(S,{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Provider"}),e.jsx("p",{className:"mt-1",children:s.insurance?.provider||"Not provided"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Policy Number"}),e.jsx("p",{className:"mt-1 font-mono text-sm",children:s.insurance?.policyNumber||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Group Number"}),e.jsx("p",{className:"mt-1 font-mono text-sm",children:s.insurance?.groupNumber||"N/A"})]})]})]})]}),e.jsxs(E,{children:[e.jsx(k,{children:e.jsxs(R,{className:"flex items-center gap-2",children:[e.jsx(W,{className:"h-5 w-5"}),"Emergency Contact"]})}),e.jsxs(S,{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Name"}),e.jsx("p",{className:"mt-1",children:s.emergencyContact?.name||"Not provided"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Phone"}),e.jsx("p",{className:"mt-1",children:s.emergencyContact?.phone||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Relationship"}),e.jsx("p",{className:"mt-1 capitalize",children:s.emergencyContact?.relationship||"N/A"})]})]})]})]})]}),e.jsxs(E,{className:"lg:col-span-2",children:[e.jsx(k,{children:e.jsxs(R,{className:"flex items-center gap-2",children:[e.jsx(z,{className:"h-5 w-5"}),"Medical Information"]})}),e.jsxs(S,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground mb-2 block",children:"Allergies"}),s.allergies&&s.allergies.length>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:s.allergies.map((r,i)=>e.jsx(U,{variant:"destructive",className:"font-normal",children:r},i))}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"No known allergies"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground mb-2 block",children:"Current Medications"}),s.currentMedications&&s.currentMedications.length>0?e.jsx("ul",{className:"space-y-1",children:s.currentMedications.map((r,i)=>e.jsxs("li",{className:"text-sm flex items-start gap-2",children:[e.jsx("span",{className:"text-muted-foreground",children:"•"}),e.jsx("span",{children:r})]},i))}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"No current medications"})]})]})]})]})}function hs({events:s,isLoading:t}){const a=c=>{switch(c){case"APPOINTMENT":return G;case"LAB_RESULT":return Ge;case"PRESCRIPTION":return z;case"MEDICAL_RECORD":default:return B}},n=c=>{switch(c){case"APPOINTMENT":return"bg-blue-100 text-blue-700";case"LAB_RESULT":return"bg-purple-100 text-purple-700";case"PRESCRIPTION":return"bg-green-100 text-green-700";case"MEDICAL_RECORD":default:return"bg-gray-100 text-gray-700"}},r=c=>{if(!c)return"secondary";const l=c.toLowerCase();return l==="completed"||l==="final"?"default":l==="scheduled"||l==="confirmed"?"secondary":l==="cancelled"?"destructive":"secondary"},i=c=>{try{const l=ve(c);return ze(l)?"Today":_e(l)?"Yesterday":Ze(l)?I(l,"EEEE"):I(l,"MMMM d, yyyy")}catch{return c}},j=c=>{try{return I(ve(c),"h:mm a")}catch{return""}},m=s.reduce((c,l)=>{const d=i(l.date);return c[d]||(c[d]=[]),c[d].push(l),c},{});return t?e.jsx("div",{className:"space-y-4",children:[...Array(3)].map((c,l)=>e.jsx(E,{className:"animate-pulse",children:e.jsx(S,{className:"p-6",children:e.jsx("div",{className:"h-20 bg-gray-200 rounded"})})},l))}):s.length===0?e.jsxs("div",{className:"bg-white border-2 border-dashed rounded-lg p-12 text-center",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"h-16 w-16 bg-primary/10 rounded-full flex items-center justify-center",children:e.jsx(G,{className:"h-8 w-8 text-primary"})})}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No timeline events yet"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Appointments and medical records will appear here"})]}):e.jsx("div",{className:"space-y-6",children:Object.entries(m).map(([c,l])=>e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-muted-foreground mb-3 sticky top-0 bg-gray-50 py-2",children:c}),e.jsx("div",{className:"space-y-3",children:l.map(d=>{const g=a(d.type),y=n(d.type);return e.jsx(E,{className:"hover:shadow-md transition-shadow cursor-pointer",children:e.jsx(S,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:`p-2 rounded-lg shrink-0 ${y}`,children:e.jsx(g,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-1",children:[e.jsx("h4",{className:"font-semibold text-sm",children:d.title}),d.status&&e.jsx(U,{variant:r(d.status),className:"shrink-0 text-xs",children:d.status})]}),d.description&&e.jsx("p",{className:"text-sm text-muted-foreground mb-2 line-clamp-2",children:d.description}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[d.providerName&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Y,{className:"h-3.5 w-3.5"}),e.jsx("span",{children:d.providerName})]}),d.date&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(G,{className:"h-3.5 w-3.5"}),e.jsx("span",{children:j(d.date)})]})]})]})]})})},d.id)})})]},c))})}const js=je({firstName:x().min(1,"First name is required"),lastName:x().min(1,"Last name is required"),phoneNumber:x().optional(),dateOfBirth:x().optional(),gender:x().optional(),addressLine1:x().optional(),addressLine2:x().optional(),city:x().optional(),state:x().optional(),zipCode:x().regex(/^\d{5}(-\d{4})?$/,"Invalid ZIP code").optional().or(ke("")),insuranceProvider:x().optional(),insurancePolicyNumber:x().optional(),insuranceGroupNumber:x().optional(),emergencyContactName:x().optional(),emergencyContactPhone:x().optional(),emergencyContactRelationship:x().optional()});function ps({open:s,onOpenChange:t,patient:a}){const{toast:n}=se(),r=te(),[i,j]=w.useState(a.allergies||[]),[m,c]=w.useState(""),[l,d]=w.useState(a.currentMedications||[]),[g,y]=w.useState(""),{register:p,handleSubmit:D,formState:{errors:N},setValue:_,watch:$}=ae({resolver:re(js),defaultValues:{firstName:a.firstName,lastName:a.lastName,phoneNumber:a.phoneNumber||"",dateOfBirth:a.dateOfBirth||"",gender:a.gender||"",addressLine1:a.address?.line1||"",addressLine2:a.address?.line2||"",city:a.address?.city||"",state:a.address?.state||"",zipCode:a.address?.zipCode||"",insuranceProvider:a.insurance?.provider||"",insurancePolicyNumber:a.insurance?.policyNumber||"",insuranceGroupNumber:a.insurance?.groupNumber||"",emergencyContactName:a.emergencyContact?.name||"",emergencyContactPhone:a.emergencyContact?.phone||"",emergencyContactRelationship:a.emergencyContact?.relationship||""}}),L=ie({mutationFn:u=>M.updatePatient(a.id,{...u,allergies:i,currentMedications:l}),onSuccess:()=>{r.invalidateQueries({queryKey:["patient-detail",a.id]}),r.invalidateQueries({queryKey:["provider-patients"]}),n({title:"Patient updated",description:"Patient information has been updated successfully"}),t(!1)},onError:u=>{n({title:"Error updating patient",description:u.message||"An error occurred",variant:"destructive"})}}),T=u=>{L.mutate(u)},P=()=>{m.trim()&&!i.includes(m.trim())&&(j([...i,m.trim()]),c(""))},A=u=>{j(i.filter(Z=>Z!==u))},f=()=>{g.trim()&&!l.includes(g.trim())&&(d([...l,g.trim()]),y(""))},Fe=u=>{d(l.filter(Z=>Z!==u))};return e.jsx(ne,{open:s,onOpenChange:t,children:e.jsxs(le,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(ce,{children:[e.jsx(de,{children:"Edit Patient Information"}),e.jsx(oe,{children:"Update patient demographics and medical information"})]}),e.jsxs("form",{onSubmit:D(T),children:[e.jsxs(ye,{defaultValue:"personal",className:"w-full",children:[e.jsxs(be,{className:"grid w-full grid-cols-4",children:[e.jsx(F,{value:"personal",children:"Personal"}),e.jsx(F,{value:"address",children:"Address"}),e.jsx(F,{value:"insurance",children:"Insurance"}),e.jsx(F,{value:"emergency",children:"Emergency"})]}),e.jsxs(O,{value:"personal",className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(o,{htmlFor:"firstName",children:"First Name *"}),e.jsx(h,{id:"firstName",...p("firstName")}),N.firstName&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:N.firstName.message})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"lastName",children:"Last Name *"}),e.jsx(h,{id:"lastName",...p("lastName")}),N.lastName&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:N.lastName.message})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(o,{htmlFor:"dateOfBirth",children:"Date of Birth"}),e.jsx(h,{id:"dateOfBirth",type:"date",...p("dateOfBirth")})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"gender",children:"Gender"}),e.jsxs(me,{value:$("gender"),onValueChange:u=>_("gender",u),children:[e.jsx(xe,{children:e.jsx(ue,{placeholder:"Select gender"})}),e.jsxs(he,{children:[e.jsx(q,{value:"MALE",children:"Male"}),e.jsx(q,{value:"FEMALE",children:"Female"}),e.jsx(q,{value:"OTHER",children:"Other"}),e.jsx(q,{value:"PREFER_NOT_TO_SAY",children:"Prefer not to say"})]})]})]})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"phoneNumber",children:"Phone Number"}),e.jsx(h,{id:"phoneNumber",type:"tel",...p("phoneNumber")})]}),e.jsxs("div",{children:[e.jsx(o,{children:"Allergies"}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx(h,{value:m,onChange:u=>c(u.target.value),placeholder:"Add allergy",onKeyPress:u=>u.key==="Enter"&&(u.preventDefault(),P())}),e.jsx(v,{type:"button",onClick:P,children:"Add"})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:i.map(u=>e.jsxs(U,{variant:"destructive",children:[u,e.jsx("button",{type:"button",onClick:()=>A(u),className:"ml-2",children:e.jsx(pe,{className:"h-3 w-3"})})]},u))})]}),e.jsxs("div",{children:[e.jsx(o,{children:"Current Medications"}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx(h,{value:g,onChange:u=>y(u.target.value),placeholder:"Add medication",onKeyPress:u=>u.key==="Enter"&&(u.preventDefault(),f())}),e.jsx(v,{type:"button",onClick:f,children:"Add"})]}),e.jsx("div",{className:"space-y-1",children:l.map(u=>e.jsxs("div",{className:"flex items-center justify-between bg-gray-100 p-2 rounded",children:[e.jsx("span",{className:"text-sm",children:u}),e.jsx("button",{type:"button",onClick:()=>Fe(u),children:e.jsx(pe,{className:"h-4 w-4"})})]},u))})]})]}),e.jsxs(O,{value:"address",className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(o,{htmlFor:"addressLine1",children:"Address Line 1"}),e.jsx(h,{id:"addressLine1",...p("addressLine1")})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"addressLine2",children:"Address Line 2"}),e.jsx(h,{id:"addressLine2",...p("addressLine2")})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(o,{htmlFor:"city",children:"City"}),e.jsx(h,{id:"city",...p("city")})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"state",children:"State"}),e.jsx(h,{id:"state",...p("state")})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"zipCode",children:"ZIP Code"}),e.jsx(h,{id:"zipCode",...p("zipCode")}),N.zipCode&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:N.zipCode.message})]})]})]}),e.jsxs(O,{value:"insurance",className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(o,{htmlFor:"insuranceProvider",children:"Insurance Provider"}),e.jsx(h,{id:"insuranceProvider",...p("insuranceProvider")})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(o,{htmlFor:"insurancePolicyNumber",children:"Policy Number"}),e.jsx(h,{id:"insurancePolicyNumber",...p("insurancePolicyNumber")})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"insuranceGroupNumber",children:"Group Number"}),e.jsx(h,{id:"insuranceGroupNumber",...p("insuranceGroupNumber")})]})]})]}),e.jsxs(O,{value:"emergency",className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(o,{htmlFor:"emergencyContactName",children:"Contact Name"}),e.jsx(h,{id:"emergencyContactName",...p("emergencyContactName")})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(o,{htmlFor:"emergencyContactPhone",children:"Contact Phone"}),e.jsx(h,{id:"emergencyContactPhone",type:"tel",...p("emergencyContactPhone")})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"emergencyContactRelationship",children:"Relationship"}),e.jsx(h,{id:"emergencyContactRelationship",...p("emergencyContactRelationship")})]})]})]})]}),e.jsxs(Me,{className:"mt-6",children:[e.jsx(v,{type:"button",variant:"outline",onClick:()=>t(!1),disabled:L.isPending,children:"Cancel"}),e.jsx(v,{type:"submit",disabled:L.isPending,children:L.isPending?"Saving...":"Save Changes"})]})]})]})})}const Ns=je({subjective:x().max(5e3,"Subjective section cannot exceed 5000 characters").optional(),objective:x().max(5e3,"Objective section cannot exceed 5000 characters").optional(),assessment:x().min(1,"Assessment is required").max(5e3,"Assessment cannot exceed 5000 characters"),plan:x().min(1,"Plan is required").max(5e3,"Plan cannot exceed 5000 characters"),chiefComplaint:x().max(500,"Chief complaint cannot exceed 500 characters").optional(),diagnosisCodes:x().max(500,"Diagnosis codes cannot exceed 500 characters").optional()});function gs({patientId:s,patientName:t,appointmentId:a,trigger:n}){const{toast:r}=se(),i=te(),[j,m]=w.useState(!1),{register:c,handleSubmit:l,reset:d,watch:g,formState:{errors:y}}=ae({resolver:re(Ns),defaultValues:{subjective:"",objective:"",assessment:"",plan:"",chiefComplaint:"",diagnosisCodes:""}}),p=g("subjective"),D=g("objective"),N=g("assessment"),_=g("plan"),$=g("chiefComplaint"),L=g("diagnosisCodes");w.useEffect(()=>{j||d()},[j,d]);const T=ie({mutationFn:A=>M.createVisitNote(s,{...A,appointmentId:a}),onSuccess:()=>{i.invalidateQueries({queryKey:["provider","patients",s,"notes"]}),i.invalidateQueries({queryKey:["provider","patients",s,"timeline"]}),r({title:"Visit Note Created",description:"Clinical visit note has been saved successfully."}),m(!1),d()},onError:A=>{r({title:"Failed to Create Note",description:A.response?.data?.message||"Failed to create visit note. Please try again.",variant:"destructive"})}}),P=A=>{T.mutate(A)};return e.jsxs(ne,{open:j,onOpenChange:m,children:[e.jsx(Ce,{asChild:!0,children:n||e.jsxs(v,{children:[e.jsx(Te,{className:"h-4 w-4 mr-2"}),"Add Visit Note"]})}),e.jsxs(le,{className:"max-w-4xl max-h-[90vh]",children:[e.jsxs(ce,{children:[e.jsxs(de,{className:"flex items-center gap-2",children:[e.jsx(B,{className:"h-5 w-5"}),"Create Visit Note (SOAP Format)"]}),e.jsxs(oe,{children:["Document clinical visit for ",t]})]}),e.jsx(Le,{className:"max-h-[70vh] pr-4","aria-label":"Visit note form content",children:e.jsxs("form",{onSubmit:l(P),className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(o,{htmlFor:"chiefComplaint",children:["Chief Complaint ",e.jsx("span",{className:"text-muted-foreground text-xs",children:"(Optional)"})]}),e.jsx(h,{id:"chiefComplaint",...c("chiefComplaint"),placeholder:"Brief summary of visit reason",maxLength:500,autoFocus:!0}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:y.chiefComplaint?.message}),e.jsxs("span",{children:[$?.length||0,"/500"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(o,{htmlFor:"subjective",className:"text-lg font-semibold text-primary",children:["S - Subjective ",e.jsx("span",{className:"text-muted-foreground text-sm font-normal",children:"(Optional)"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Patient's description: symptoms, concerns, history, what they tell you"}),e.jsx(V,{id:"subjective",...c("subjective"),placeholder:"Patient reports...",rows:4,maxLength:5e3,className:"resize-y"}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsx("span",{className:"text-destructive",children:y.subjective?.message}),e.jsxs("span",{children:[p?.length||0,"/5000"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(o,{htmlFor:"objective",className:"text-lg font-semibold text-primary",children:["O - Objective ",e.jsx("span",{className:"text-muted-foreground text-sm font-normal",children:"(Optional)"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Provider's observations: exam findings, vital signs, lab results, what you observe"}),e.jsx(V,{id:"objective",...c("objective"),placeholder:"Physical examination reveals...",rows:4,maxLength:5e3,className:"resize-y"}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsx("span",{className:"text-destructive",children:y.objective?.message}),e.jsxs("span",{children:[D?.length||0,"/5000"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(o,{htmlFor:"assessment",className:"text-lg font-semibold text-primary",children:["A - Assessment ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Diagnosis, clinical impression, problem list, what you think"}),e.jsx(V,{id:"assessment",...c("assessment"),placeholder:"Diagnosis: ...",rows:4,maxLength:5e3,className:"resize-y"}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsx("span",{className:"text-destructive",children:y.assessment?.message}),e.jsxs("span",{children:[N?.length||0,"/5000"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(o,{htmlFor:"plan",className:"text-lg font-semibold text-primary",children:["P - Plan ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Treatment plan, medications, procedures, follow-up, what you'll do"}),e.jsx(V,{id:"plan",...c("plan"),placeholder:"Treatment plan: ...",rows:4,maxLength:5e3,className:"resize-y"}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsx("span",{className:"text-destructive",children:y.plan?.message}),e.jsxs("span",{children:[_?.length||0,"/5000"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(o,{htmlFor:"diagnosisCodes",children:["ICD-10 Codes ",e.jsx("span",{className:"text-muted-foreground text-xs",children:"(Optional, comma-separated)"})]}),e.jsx(h,{id:"diagnosisCodes",...c("diagnosisCodes"),placeholder:"e.g., J06.9, R50.9",maxLength:500}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:y.diagnosisCodes?.message}),e.jsxs("span",{children:[L?.length||0,"/500"]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(v,{type:"button",variant:"outline",onClick:()=>{m(!1),d()},disabled:T.isPending,children:"Cancel"}),e.jsxs(v,{type:"submit",disabled:T.isPending,children:[T.isPending&&e.jsx(Ee,{className:"mr-2 h-4 w-4 animate-spin"}),"Save Visit Note"]})]})]})})]})]})}const fs=je({medicationName:x().min(1,"Medication name is required").max(200),dosage:x().min(1,"Dosage is required").max(100),route:x().optional(),frequency:x().min(1,"Frequency is required").max(100),duration:x().max(100).optional(),quantity:Ne().min(1,"Quantity must be at least 1"),refills:Ne().min(0,"Refills cannot be negative").max(12,"Refills cannot exceed 12"),instructions:x().max(2e3).optional(),diagnosis:x().max(500).optional(),pharmacyNotes:x().max(2e3).optional(),expiresAt:x().optional()}),vs=[{value:"ORAL",label:"Oral"},{value:"TOPICAL",label:"Topical"},{value:"INJECTION",label:"Injection"},{value:"INTRAVENOUS",label:"Intravenous (IV)"},{value:"SUBLINGUAL",label:"Sublingual"},{value:"RECTAL",label:"Rectal"},{value:"TRANSDERMAL",label:"Transdermal (Patch)"},{value:"INHALATION",label:"Inhalation"},{value:"OPHTHALMIC",label:"Ophthalmic (Eye)"},{value:"OTIC",label:"Otic (Ear)"},{value:"NASAL",label:"Nasal"}];function ys({patientId:s,patientName:t,visitNoteId:a,trigger:n}){const{toast:r}=se(),i=te(),[j,m]=w.useState(!1),{user:c}=we(),l=c?.role==="doctor",{register:d,handleSubmit:g,setValue:y,watch:p,reset:D,formState:{errors:N}}=ae({resolver:re(fs),defaultValues:{medicationName:"",dosage:"",route:"",frequency:"",duration:"",quantity:30,refills:0,instructions:"",diagnosis:"",pharmacyNotes:"",expiresAt:""}}),_=p("route"),$=p("instructions"),L=p("diagnosis"),T=p("pharmacyNotes");w.useEffect(()=>{j||D()},[j,D]);const P=ie({mutationFn:f=>M.createPrescription(s,{...f,route:f.route&&f.route.length>0?f.route:void 0,visitNoteId:a}),onSuccess:()=>{i.invalidateQueries({queryKey:["provider","patients",s,"prescriptions"]}),i.invalidateQueries({queryKey:["provider","patients",s,"timeline"]}),r({title:"Prescription Created",description:"Prescription has been saved successfully."}),m(!1),D()},onError:f=>{r({title:"Failed to Create Prescription",description:f.response?.data?.message||"Failed to create prescription. Please try again.",variant:"destructive"})}}),A=f=>{P.mutate(f)};return l?e.jsxs(ne,{open:j,onOpenChange:m,children:[e.jsx(Ce,{asChild:!0,children:n||e.jsxs(v,{children:[e.jsx(Te,{className:"h-4 w-4 mr-2"}),"Write Prescription"]})}),e.jsxs(le,{className:"max-w-3xl max-h-[90vh]",children:[e.jsxs(ce,{children:[e.jsxs(de,{className:"flex items-center gap-2",children:[e.jsx(z,{className:"h-5 w-5"}),"Write Prescription"]}),e.jsxs(oe,{children:["Create new prescription for ",t]})]}),e.jsx(Le,{className:"max-h-[70vh] pr-4","aria-label":"Prescription form content",children:e.jsxs("form",{onSubmit:g(A),className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(o,{htmlFor:"medicationName",children:["Medication Name ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(h,{id:"medicationName",...d("medicationName"),placeholder:"e.g., Amoxicillin",maxLength:200,autoFocus:!0}),N.medicationName&&e.jsx("p",{className:"text-sm text-destructive",children:N.medicationName.message})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(o,{htmlFor:"dosage",children:["Dosage ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(h,{id:"dosage",...d("dosage"),placeholder:"e.g., 500 mg",maxLength:100}),N.dosage&&e.jsx("p",{className:"text-sm text-destructive",children:N.dosage.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"route",children:"Route"}),e.jsxs(me,{value:_,onValueChange:f=>y("route",f),children:[e.jsx(xe,{children:e.jsx(ue,{placeholder:"Select route"})}),e.jsx(he,{children:vs.map(f=>e.jsx(q,{value:f.value,children:f.label},f.value))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(o,{htmlFor:"frequency",children:["Frequency ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(h,{id:"frequency",...d("frequency"),placeholder:"e.g., Twice daily",maxLength:100}),N.frequency&&e.jsx("p",{className:"text-sm text-destructive",children:N.frequency.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"duration",children:"Duration"}),e.jsx(h,{id:"duration",...d("duration"),placeholder:"e.g., 7 days",maxLength:100})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(o,{htmlFor:"quantity",children:["Quantity ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(h,{id:"quantity",type:"number",...d("quantity",{valueAsNumber:!0}),placeholder:"30",min:1}),N.quantity&&e.jsx("p",{className:"text-sm text-destructive",children:N.quantity.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"refills",children:"Refills"}),e.jsx(h,{id:"refills",type:"number",...d("refills",{valueAsNumber:!0}),placeholder:"0",min:0,max:12}),N.refills&&e.jsx("p",{className:"text-sm text-destructive",children:N.refills.message})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"instructions",children:"Instructions for Patient"}),e.jsx(V,{id:"instructions",...d("instructions"),placeholder:"e.g., Take with food. Complete full course even if symptoms improve.",rows:3,maxLength:2e3,className:"resize-y"}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:N.instructions?.message}),e.jsxs("span",{children:[$?.length||0,"/2000"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"diagnosis",children:"Diagnosis / Indication"}),e.jsx(h,{id:"diagnosis",...d("diagnosis"),placeholder:"e.g., Bacterial sinusitis",maxLength:500}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:N.diagnosis?.message}),e.jsxs("span",{children:[L?.length||0,"/500"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"pharmacyNotes",children:"Notes for Pharmacy"}),e.jsx(V,{id:"pharmacyNotes",...d("pharmacyNotes"),placeholder:"Special instructions for pharmacy",rows:2,maxLength:2e3,className:"resize-y"}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:N.pharmacyNotes?.message}),e.jsxs("span",{children:[T?.length||0,"/2000"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"expiresAt",children:"Expiration Date (Optional)"}),e.jsx(h,{id:"expiresAt",type:"date",...d("expiresAt")}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Date when prescription can no longer be filled"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(v,{type:"button",variant:"outline",onClick:()=>{m(!1),D()},disabled:P.isPending,children:"Cancel"}),e.jsxs(v,{type:"submit",disabled:P.isPending,children:[P.isPending&&e.jsx(Ee,{className:"mr-2 h-4 w-4 animate-spin"}),"Create Prescription"]})]})]})})]})]}):e.jsxs(v,{disabled:!0,variant:"outline",className:"cursor-not-allowed",children:[e.jsx(z,{className:"h-4 w-4 mr-2"}),"Write Prescription (Doctors Only)"]})}function bs({note:s,className:t}){return e.jsxs(E,{className:t,children:[e.jsxs(k,{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(B,{className:"h-5 w-5 text-primary"}),e.jsx(R,{className:"text-lg",children:"Visit Note"})]}),e.jsx(U,{variant:"outline",className:"text-xs",children:I(new Date(s.createdAt),"MMM dd, yyyy")})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-muted-foreground mt-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Y,{className:"h-4 w-4"}),e.jsxs("span",{children:["Dr. ",s.provider.firstName," ",s.provider.lastName]})]}),s.provider.specialty&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{children:"•"}),e.jsx("span",{children:s.provider.specialty})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(G,{className:"h-4 w-4"}),e.jsx("span",{children:I(new Date(s.createdAt),"h:mm a")})]})]}),s.chiefComplaint&&e.jsxs("div",{className:"mt-3 p-3 bg-muted/50 rounded-md",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:"Chief Complaint"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:s.chiefComplaint})]})]}),e.jsxs(S,{className:"space-y-4",children:[s.subjective&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h4",{className:"text-sm font-semibold text-primary flex items-center gap-2",children:[e.jsx("span",{className:"bg-primary text-primary-foreground rounded-full w-6 h-6 flex items-center justify-center text-xs",children:"S"}),"Subjective"]}),e.jsx("p",{className:"text-sm text-foreground ml-8 whitespace-pre-wrap",children:s.subjective})]}),s.objective&&e.jsxs(e.Fragment,{children:[e.jsx(C,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h4",{className:"text-sm font-semibold text-primary flex items-center gap-2",children:[e.jsx("span",{className:"bg-primary text-primary-foreground rounded-full w-6 h-6 flex items-center justify-center text-xs",children:"O"}),"Objective"]}),e.jsx("p",{className:"text-sm text-foreground ml-8 whitespace-pre-wrap",children:s.objective})]})]}),e.jsx(C,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h4",{className:"text-sm font-semibold text-primary flex items-center gap-2",children:[e.jsx("span",{className:"bg-primary text-primary-foreground rounded-full w-6 h-6 flex items-center justify-center text-xs",children:"A"}),"Assessment"]}),e.jsx("p",{className:"text-sm text-foreground ml-8 whitespace-pre-wrap",children:s.assessment})]}),e.jsx(C,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h4",{className:"text-sm font-semibold text-primary flex items-center gap-2",children:[e.jsx("span",{className:"bg-primary text-primary-foreground rounded-full w-6 h-6 flex items-center justify-center text-xs",children:"P"}),"Plan"]}),e.jsx("p",{className:"text-sm text-foreground ml-8 whitespace-pre-wrap",children:s.plan})]}),s.diagnosisCodes&&e.jsxs(e.Fragment,{children:[e.jsx(C,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"ICD-10 Codes"}),e.jsx("div",{className:"flex flex-wrap gap-2 ml-0",children:s.diagnosisCodes.split(",").map((a,n)=>e.jsx(U,{variant:"secondary",className:"text-xs",children:a.trim()},n))})]})]})]})]})}function Cs({patientId:s}){const{data:t,isLoading:a,isError:n,error:r}=Q({queryKey:["provider","patients",s,"notes"],queryFn:()=>M.getPatientVisitNotes(s)});return a?e.jsx("div",{className:"space-y-4",children:[1,2,3].map(i=>e.jsxs("div",{className:"space-y-3 p-4 border rounded-lg",children:[e.jsx(b,{className:"h-6 w-1/3"}),e.jsx(b,{className:"h-4 w-full"}),e.jsx(b,{className:"h-4 w-full"}),e.jsx(b,{className:"h-4 w-2/3"})]},i))}):n?e.jsxs("div",{className:"bg-destructive/10 border border-destructive/20 rounded-lg p-6 text-center",children:[e.jsx(W,{className:"h-8 w-8 text-destructive mx-auto mb-2"}),e.jsx("h3",{className:"text-lg font-semibold text-destructive mb-2",children:"Error Loading Visit Notes"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:r?.response?.data?.message||"Failed to load visit notes. Please try again."})]}):!t||t.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(B,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Visit Notes"}),e.jsx("p",{className:"text-sm text-muted-foreground max-w-md",children:'No clinical visit notes have been created for this patient yet. Click "Add Visit Note" to create one.'})]}):e.jsx("div",{className:"space-y-4",children:t.map(i=>e.jsx(bs,{note:i},i.id))})}const ws={ACTIVE:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",COMPLETED:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",CANCELLED:"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200",DISCONTINUED:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200"},Ps={ORAL:"Oral",TOPICAL:"Topical",INJECTION:"Injection",INTRAVENOUS:"Intravenous (IV)",SUBLINGUAL:"Sublingual",RECTAL:"Rectal",TRANSDERMAL:"Transdermal",INHALATION:"Inhalation",OPHTHALMIC:"Ophthalmic (Eye)",OTIC:"Otic (Ear)",NASAL:"Nasal"};function As({prescription:s,className:t}){return e.jsxs(E,{className:t,children:[e.jsxs(k,{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{className:"h-5 w-5 text-primary"}),e.jsx(R,{className:"text-lg",children:s.medicationName})]}),e.jsx(U,{className:ws[s.status],children:s.status.toLowerCase()})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-muted-foreground mt-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Y,{className:"h-4 w-4"}),e.jsxs("span",{children:["Dr. ",s.provider.firstName," ",s.provider.lastName]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(G,{className:"h-4 w-4"}),e.jsxs("span",{children:["Prescribed ",I(new Date(s.prescribedDate),"MMM dd, yyyy")]})]})]}),s.status==="DISCONTINUED"&&s.discontinuedReason&&e.jsxs("div",{className:"mt-3 p-3 bg-orange-50 dark:bg-orange-950 border border-orange-200 dark:border-orange-800 rounded-md flex items-start gap-2",children:[e.jsx(W,{className:"h-5 w-5 text-orange-600 dark:text-orange-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-orange-900 dark:text-orange-100",children:"Discontinued"}),e.jsx("p",{className:"text-sm text-orange-700 dark:text-orange-300 mt-1",children:s.discontinuedReason})]})]})]}),e.jsxs(S,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-1",children:"Dosage"}),e.jsx("p",{className:"text-sm font-semibold text-foreground",children:s.dosage})]}),s.route&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-1",children:"Route"}),e.jsx("p",{className:"text-sm font-semibold text-foreground",children:Ps[s.route]||s.route})]})]}),e.jsx(C,{}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-1",children:"Frequency"}),e.jsx("p",{className:"text-sm text-foreground",children:s.frequency})]}),s.duration&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-1",children:"Duration"}),e.jsx("p",{className:"text-sm text-foreground",children:s.duration})]})]}),e.jsx(C,{}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-1",children:"Quantity"}),e.jsx("p",{className:"text-sm text-foreground",children:s.quantity})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-1",children:"Refills"}),e.jsx("p",{className:"text-sm text-foreground",children:s.refills})]})]}),s.instructions&&e.jsxs(e.Fragment,{children:[e.jsx(C,{}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-2",children:"Instructions"}),e.jsx("p",{className:"text-sm text-foreground whitespace-pre-wrap",children:s.instructions})]})]}),s.diagnosis&&e.jsxs(e.Fragment,{children:[e.jsx(C,{}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-1",children:"Diagnosis / Indication"}),e.jsx("p",{className:"text-sm text-foreground",children:s.diagnosis})]})]}),s.expiresAt&&e.jsxs(e.Fragment,{children:[e.jsx(C,{}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-1",children:"Expires"}),e.jsx("p",{className:"text-sm text-foreground",children:I(new Date(s.expiresAt),"MMM dd, yyyy")})]})]}),s.pharmacyNotes&&e.jsxs(e.Fragment,{children:[e.jsx(C,{}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-2",children:"Pharmacy Notes"}),e.jsx("p",{className:"text-sm text-muted-foreground italic whitespace-pre-wrap",children:s.pharmacyNotes})]})]})]})]})}const Ds=[{value:"ALL",label:"All Prescriptions"},{value:"ACTIVE",label:"Active"},{value:"COMPLETED",label:"Completed"},{value:"DISCONTINUED",label:"Discontinued"},{value:"CANCELLED",label:"Cancelled"}];function Ls({patientId:s}){const[t,a]=w.useState("ALL"),{data:n,isLoading:r,isError:i,error:j}=Q({queryKey:["provider","patients",s,"prescriptions",t],queryFn:()=>M.getPatientPrescriptions(s,t==="ALL"?void 0:t)});return r?e.jsx("div",{className:"space-y-4",children:[1,2,3].map(m=>e.jsxs("div",{className:"space-y-3 p-4 border rounded-lg",children:[e.jsx(b,{className:"h-6 w-1/3"}),e.jsx(b,{className:"h-4 w-full"}),e.jsx(b,{className:"h-4 w-full"}),e.jsx(b,{className:"h-4 w-2/3"})]},m))}):i?e.jsxs("div",{className:"bg-destructive/10 border border-destructive/20 rounded-lg p-6 text-center",children:[e.jsx(W,{className:"h-8 w-8 text-destructive mx-auto mb-2"}),e.jsx("h3",{className:"text-lg font-semibold text-destructive mb-2",children:"Error Loading Prescriptions"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:j?.response?.data?.message||"Failed to load prescriptions. Please try again."})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(me,{value:t,onValueChange:a,children:[e.jsx(xe,{className:"w-[200px]",children:e.jsx(ue,{placeholder:"Filter by status"})}),e.jsx(he,{children:Ds.map(m=>e.jsx(q,{value:m.value,children:m.label},m.value))})]}),t&&t!=="ALL"&&e.jsx(v,{variant:"ghost",size:"sm",onClick:()=>a("ALL"),children:"Clear Filter"})]}),!n||n.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(z,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Prescriptions"}),e.jsx("p",{className:"text-sm text-muted-foreground max-w-md",children:t&&t!=="ALL"?`No ${t.toLowerCase()} prescriptions found for this patient.`:'No prescriptions have been written for this patient yet. Click "Write Prescription" to create one.'})]}):e.jsx("div",{className:"space-y-4",children:n.map(m=>e.jsx(As,{prescription:m},m.id))})]})}function Bs(){const{id:s}=Re(),t=qe(),{user:a}=we(),[n,r]=w.useState(!1),{data:i,isLoading:j,isError:m,error:c}=Q({queryKey:["patient-detail",s],queryFn:()=>M.getPatientDetail(s),enabled:!!s,staleTime:0}),{data:l,isLoading:d}=Q({queryKey:["patient-timeline",s],queryFn:()=>M.getPatientTimeline(s),enabled:!!s,staleTime:0}),g=a?.role==="doctor";return j?e.jsxs("div",{className:"h-screen flex flex-col bg-gray-50",children:[e.jsx(J,{title:"Patient Details",showBackButton:!0,backPath:"/provider/patients"}),e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[e.jsx(b,{className:"h-8 w-64 mb-4"}),e.jsx(b,{className:"h-10 w-full max-w-md mb-6"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(b,{className:"h-96"}),e.jsx(b,{className:"h-96"})]})]})})]}):m||!i?e.jsxs("div",{className:"h-screen flex flex-col bg-gray-50",children:[e.jsx(J,{title:"Patient Details",showBackButton:!0,backPath:"/provider/patients"}),e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"bg-destructive/10 border border-destructive/20 rounded-lg p-6 text-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-destructive mb-2",children:"Error Loading Patient"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:c instanceof Error?c.message:"Patient not found or you do not have permission to access this patient"}),e.jsx(v,{onClick:()=>t("/provider/patients"),children:"Back to Patients"})]})})})]}):e.jsxs("div",{className:"h-screen flex flex-col bg-gray-50",children:[e.jsx(J,{title:`${i.firstName} ${i.lastName}`,showBackButton:!0,backPath:"/provider/patients"}),e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:[i.firstName," ",i.lastName,i.age&&e.jsxs("span",{className:"text-lg text-muted-foreground font-normal ml-2",children:["(",i.age," years old)"]})]}),i.medicalRecordNumber&&e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["MRN: ",i.medicalRecordNumber]})]}),g&&e.jsxs(v,{onClick:()=>r(!0),children:[e.jsx($e,{className:"h-4 w-4 mr-2"}),"Edit Patient"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsx("div",{className:"bg-white rounded-lg border p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(Y,{className:"h-5 w-5 text-blue-700"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:i.totalAppointments||0}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Appointments"})]})]})}),e.jsx("div",{className:"bg-white rounded-lg border p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(B,{className:"h-5 w-5 text-purple-700"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:i.totalRecords||0}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Medical Records"})]})]})}),e.jsx("div",{className:"bg-white rounded-lg border p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(B,{className:"h-5 w-5 text-green-700"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Last Visit"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:i.lastAppointmentDate||"No visits yet"})]})]})})]}),e.jsxs(ye,{defaultValue:"overview",className:"w-full",children:[e.jsxs(be,{className:"mb-4",children:[e.jsx(F,{value:"overview",children:"Overview"}),e.jsx(F,{value:"timeline",children:"Medical Timeline"}),e.jsx(F,{value:"notes",children:"Clinical Notes"}),e.jsx(F,{value:"prescriptions",children:"Prescriptions"})]}),e.jsx(O,{value:"overview",children:e.jsx(us,{patient:i})}),e.jsx(O,{value:"timeline",children:e.jsx(hs,{events:l||[],isLoading:d})}),e.jsx(O,{value:"notes",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Clinical Visit Notes"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"SOAP format documentation of patient visits"})]}),e.jsx(gs,{patientId:s,patientName:`${i.firstName} ${i.lastName}`})]}),e.jsx(Cs,{patientId:s})]})}),e.jsx(O,{value:"prescriptions",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Prescriptions"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Medication prescriptions for this patient"})]}),e.jsx(ys,{patientId:s,patientName:`${i.firstName} ${i.lastName}`})]}),e.jsx(Ls,{patientId:s})]})})]})]})}),g&&e.jsx(ps,{open:n,onOpenChange:r,patient:i})]})}export{Bs as default};
